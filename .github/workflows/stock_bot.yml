name: Stock Alarm Bot

on:
  schedule:
    # 1. ì¥ì „ ì ê²€: í•œêµ­ì‹œê°„ 08:50 (UTC ê¸°ì¤€ 23:50 ì „ë‚ )
    - cron: "50 23 * * 0-4"

    # 2. ì¥í›„ ê²°ì‚°: í•œêµ­ì‹œê°„ 15:40 (UTC ê¸°ì¤€ 06:40 ë‹¹ì¼)
    - cron: "40 6 * * 1-5"

  # âœ… ê¸°ì¡´ ìˆ˜ë™ ì‹¤í–‰ìš©
  workflow_dispatch:
    inputs:
      logLevel:
        description: "Log level"
        required: false
        default: "warning"

  # âœ… ì™¸ë¶€(í…”ë ˆê·¸ë¨ ë´‡)ì—ì„œ ì‹ í˜¸ë¥¼ ë³´ë‚¼ ì…êµ¬ (ì—¬ê¸°ê°€ í¬ì¸íŠ¸!)
  repository_dispatch:
    types: [telegram_trigger]

jobs:
  build:
    runs-on: ubuntu-latest
    env:
      TELEGRAM_TOKEN: "${{ secrets.TELEGRAM_TOKEN }}"
      TELEGRAM_CHAT_ID: "${{ secrets.TELEGRAM_CHAT_ID }}"
      OPENDART_API_KEY: "${{ secrets.OPENDART_API_KEY }}"

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          # ğŸ‘‡ [ìˆ˜ì •] íŒŒì¼ ì•ì— í´ë”ëª…ì„ ë¶™ì—¬ì¤ë‹ˆë‹¤.
          pip install -r stock-alarm-bot/requirements.txt

      - name: Run Market Analysis
        run: |
          # ğŸ‘‡ [ìˆ˜ì •] í´ë” ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ì„œ íŒŒì´ì¬ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
          cd stock-alarm-bot
          python main.py
